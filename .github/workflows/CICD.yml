name: CI + CD

on:
    push:
        branches: [ main ]
    pull_request:
        branches: [ main ]
    workflow_dispatch:

jobs:
    Build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2

            - name: Compile
              run: echo Hello, world!

    DeployDev:
        name: Deploy to Dev
        if: github.event_name == 'pull_request'
        needs: [Build]
        runs-on: ubuntu-latest
        environment:
            name: Development
            url: 'https://dev.mypp.com'
        steps:
            - name: Deploy
              run: echo I am deploying to Dev env!
    
    DeployStaging:
        name: Deploy to Staging
        if: github.event.ref == 'refs/heads/main'
        needs: [Build]
        runs-on: ubuntu-latest
        environment:
            name: Staging
            url: 'https://test.mypp.com'
        steps:
            - name: Deploy
              run: echo I am deploying to Staging env!

    DeployProd:
        name: Deploy to Prod
        if: github.event.ref == 'refs/heads/main'
        needs: [Build]
        runs-on: ubuntu-latest
        environment:
            name: Production
            url: 'https://prod.mypp.com'
        steps:
            - name: Deploy
              run: echo I am deploying to Production env!

        
        

